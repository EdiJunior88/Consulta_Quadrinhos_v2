name: Auto-Merge Dependabot PRs

on:
  pull_request:
    types:
      - labeled
    branches:
      - main

jobs:
  auto_merge:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v2

      - name: Auto-Merge PR
        run: |
          PR_TITLE=$(jq -r '.pull_request.title' $GITHUB_EVENT_PATH)
          PR_LABELS=$(jq -r '.pull_request.labels[].name' $GITHUB_EVENT_PATH)

          # Se o PR tiver a etiqueta Dependabot, mesclar automaticamente
          if [[ "$PR_LABELS" == *"Dependabot"* ]]; then
            echo "Merging Dependabot PR"
            gh pr merge $GITHUB_EVENT_NUMBER --auto --merge
          else
            echo "Not a Dependabot PR, skipping auto-merge"
          fi
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
